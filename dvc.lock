schema: '2.0'
stages:
  teacher_train:
    cmd: python src/teacher_train.py
    deps:
    - path: src/teacher_train.py
      hash: md5
      md5: 4109067fc0103c461ae1cacecd3e8050
      size: 5467
    - path: src/utils/utils.py
      hash: md5
      md5: 9bc58ecd1bbe83f07051335af1134905
      size: 3647
    params:
      params.yaml:
        train-teacher:
          lr: 2e-05
          epochs: 3
          batch_size: 10
          weight_decay: 0.01
          subset_size: 6000
    outs:
    - path: metrics/teacher/training_plot.png
      hash: md5
      md5: 332a7db73303538a53936b54f15c6c59
      size: 35654
    - path: models/teacher.pt
      hash: md5
      md5: c8bbb7e346471a499d5338034d01fb52
      size: 343292938
  teacher_test:
    cmd: python src/teacher_test.py
    deps:
    - path: models/teacher.pt
      hash: md5
      md5: c8bbb7e346471a499d5338034d01fb52
      size: 343292938
    - path: src/teacher_test.py
      hash: md5
      md5: 66857833776962d269cfe5b44c8e69ec
      size: 4480
    params:
      params.yaml:
        train-student:
          lr: 0.0001
          epochs: 10
          batch_size: 32
          temperature: 5
          alpha: 0.3
          subset_size: 6000
        train-teacher:
          lr: 2e-05
          epochs: 3
          batch_size: 10
          weight_decay: 0.01
          subset_size: 6000
    outs:
    - path: data/teacher.npy
      hash: md5
      md5: 7e95a0bdbe7068f28b84fbf1243be3a3
      size: 192128
    - path: metrics/teacher/confusion_matrix.png
      hash: md5
      md5: 6a29a5bbb32237d294bd64c501da736b
      size: 40090
    - path: metrics/teacher/metrics.json
      hash: md5
      md5: dd5776ac2a6b0093255a11132d5ef53e
      size: 121
  student_train:
    cmd: python src/student_train.py
    deps:
    - path: data/teacher.npy
      hash: md5
      md5: 7e95a0bdbe7068f28b84fbf1243be3a3
      size: 192128
    - path: src/student_train.py
      hash: md5
      md5: 9fd7c32baadd4f891947179b54137e48
      size: 8881
    - path: src/utils/utils.py
      hash: md5
      md5: 9bc58ecd1bbe83f07051335af1134905
      size: 3647
    params:
      params.yaml:
        train-student:
          lr: 0.0001
          epochs: 10
          batch_size: 32
          temperature: 5
          alpha: 0.3
          subset_size: 6000
    outs:
    - path: metrics/student/training_plot.png
      hash: md5
      md5: 28ac4e8533d274d29491d042df86e19d
      size: 27474
    - path: models/student.pt
      hash: md5
      md5: 29ce2e35bf91679e4aeaaa375f8318a8
      size: 103147868
  student_test:
    cmd: python src/student_test.py
    deps:
    - path: models/student.pt
      hash: md5
      md5: 29ce2e35bf91679e4aeaaa375f8318a8
      size: 103147868
    - path: src/student_test.py
      hash: md5
      md5: d8d1a6986aa25256d4e8aafe4fdf9cd2
      size: 3486
    params:
      params.yaml:
        train-student:
          lr: 0.0001
          epochs: 10
          batch_size: 32
          temperature: 5
          alpha: 0.3
          subset_size: 6000
    outs:
    - path: metrics/student/confusion_matrix.png
      hash: md5
      md5: 321680e7a843dd489bff73cebf2159fc
      size: 49633
    - path: metrics/student/metrics.json
      hash: md5
      md5: b057606b7626ac171a9e5343030a08d4
      size: 110
