schema: '2.0'
stages:
  teacher_train:
    cmd: python src/teacher_train.py
    deps:
    - path: src/teacher_train.py
      hash: md5
      md5: 4109067fc0103c461ae1cacecd3e8050
      size: 5467
    - path: src/utils/utils.py
      hash: md5
      md5: 9bc58ecd1bbe83f07051335af1134905
      size: 3647
    params:
      params.yaml:
        train-teacher:
          lr: 2e-05
          epochs: 3
          batch_size: 10
          weight_decay: 0.01
          subset_size: 6000
    outs:
    - path: metrics/teacher/training_plot.png
      hash: md5
      md5: 332a7db73303538a53936b54f15c6c59
      size: 35654
    - path: models/teacher.pt
      hash: md5
      md5: c8bbb7e346471a499d5338034d01fb52
      size: 343292938
  teacher_test:
    cmd: python src/teacher_test.py
    deps:
    - path: models/teacher.pt
      hash: md5
      md5: c8bbb7e346471a499d5338034d01fb52
      size: 343292938
    - path: src/teacher_test.py
      hash: md5
      md5: 66857833776962d269cfe5b44c8e69ec
      size: 4480
    params:
      params.yaml:
        train-student:
          lr: 0.001
          epochs: 10
          batch_size: 32
          temperature: 5
          alpha: 0.3
          subset_size: 300
        train-teacher:
          lr: 2e-05
          epochs: 3
          batch_size: 10
          weight_decay: 0.01
          subset_size: 6000
    outs:
    - path: data/teacher.npy
      hash: md5
      md5: 5ab71866550ae7d2d428d355e44b8d65
      size: 9728
    - path: metrics/teacher/confusion_matrix.png
      hash: md5
      md5: 6a29a5bbb32237d294bd64c501da736b
      size: 40090
    - path: metrics/teacher/metrics.json
      hash: md5
      md5: dd5776ac2a6b0093255a11132d5ef53e
      size: 121
  student_train:
    cmd: python src/student_train.py
    deps:
    - path: data/teacher.npy
      hash: md5
      md5: 5ab71866550ae7d2d428d355e44b8d65
      size: 9728
    - path: src/student_train.py
      hash: md5
      md5: c0945867ce61a984bfe42d59e03fc448
      size: 9993
    - path: src/utils/utils.py
      hash: md5
      md5: 9bc58ecd1bbe83f07051335af1134905
      size: 3647
    params:
      params.yaml:
        train-student:
          lr: 0.001
          epochs: 10
          batch_size: 32
          temperature: 5
          alpha: 0.3
          subset_size: 300
    outs:
    - path: metrics/student/training_plot.png
      hash: md5
      md5: 7f5d2ff5d1c33330c103acc532ddcdad
      size: 32953
    - path: models/student.pt
      hash: md5
      md5: 7e49c59daeb8c0dd8b301bea35ddb38b
      size: 103147868
  student_test:
    cmd: python src/student_test.py
    deps:
    - path: models/student.pt
      hash: md5
      md5: 7e49c59daeb8c0dd8b301bea35ddb38b
      size: 103147868
    - path: src/student_test.py
      hash: md5
      md5: d8d1a6986aa25256d4e8aafe4fdf9cd2
      size: 3486
    params:
      params.yaml:
        train-student:
          lr: 0.001
          epochs: 10
          batch_size: 32
          temperature: 5
          alpha: 0.3
          subset_size: 300
    outs:
    - path: metrics/student/confusion_matrix.png
      hash: md5
      md5: 4cc66b171307b58ad4c4bac8173de532
      size: 34466
    - path: metrics/student/metrics.json
      hash: md5
      md5: 155aa8bd11431a0175e41adb911b2465
      size: 124
